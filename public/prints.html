<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Mirror's Echo - Order Prints</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://js.stripe.com/v3/"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Cormorant Garamond', Georgia, serif;
            background: linear-gradient(135deg, #0a0608 0%, #1a1018 50%, #0a0608 100%);
            color: #f4e4ba;
            min-height: 100vh;
        }
        
        .header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(180deg, rgba(212,175,55,0.1) 0%, transparent 100%);
            border-bottom: 1px solid rgba(212,175,55,0.3);
        }
        .header h1 {
            font-family: 'Cinzel', serif;
            font-size: 2.5rem;
            color: #d4af37;
            letter-spacing: 6px;
            text-transform: uppercase;
            margin-bottom: 10px;
        }
        .header p {
            font-size: 1.1rem;
            color: rgba(244,228,186,0.8);
            font-style: italic;
        }
        .back-link {
            display: inline-block;
            margin-top: 15px;
            color: #d4af37;
            text-decoration: none;
            font-family: 'Cinzel', serif;
            font-size: 0.85rem;
            letter-spacing: 2px;
            transition: all 0.3s;
        }
        .back-link:hover { color: #f4e4ba; }
        
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        .section-title {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            color: #d4af37;
            letter-spacing: 4px;
            text-transform: uppercase;
            text-align: center;
            margin-bottom: 40px;
        }
        .section-title::after {
            content: '‚öú';
            display: block;
            margin-top: 15px;
            font-size: 1rem;
            opacity: 0.6;
        }
        
        .captures-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 30px;
            margin-bottom: 60px;
        }
        
        .capture-card {
            background: rgba(15,10,12,0.95);
            border: 1px solid rgba(212,175,55,0.3);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        .capture-card:hover {
            border-color: #d4af37;
            box-shadow: 0 0 40px rgba(212,175,55,0.25);
        }
        .capture-card.empty {
            opacity: 0.3;
            pointer-events: none;
        }

        /* Frame Preview Styles */
        .frame-preview-container {
            padding: 30px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 380px;
            background: 
                radial-gradient(ellipse at center, rgba(40,35,38,0.8) 0%, rgba(15,12,14,1) 70%),
                linear-gradient(135deg, #1a1518 0%, #0d0a0c 100%);
            position: relative;
        }
        /* Wall texture hint */
        .frame-preview-container::before {
            content: '';
            position: absolute;
            inset: 0;
            background: url("data:image/svg+xml,%3Csvg viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
            opacity: 0.03;
            pointer-events: none;
        }
        
        .frame-preview {
            position: relative;
            display: inline-block;
            transition: all 0.4s ease;
            transform-style: preserve-3d;
        }
        
        /* Standard Black Frame - Classic gallery style */
        .frame-standard {
            padding: 18px;
            background: linear-gradient(135deg, #3a3a3a 0%, #1a1a1a 50%, #2a2a2a 100%);
            border-radius: 2px;
            box-shadow: 
                /* Outer frame edge highlight */
                inset 2px 2px 0 rgba(255,255,255,0.1),
                inset -2px -2px 0 rgba(0,0,0,0.4),
                /* Inner frame depth */
                inset 0 0 0 4px #1a1a1a,
                inset 0 0 0 6px rgba(255,255,255,0.05),
                /* Wall shadow */
                8px 12px 40px rgba(0,0,0,0.7),
                4px 6px 20px rgba(0,0,0,0.5),
                /* Subtle lift */
                0 2px 4px rgba(0,0,0,0.3);
        }
        .frame-standard::before {
            content: '';
            position: absolute;
            inset: 8px;
            background: linear-gradient(180deg, rgba(255,255,255,0.03) 0%, transparent 50%);
            pointer-events: none;
        }
        /* Inner mat */
        .frame-standard::after {
            content: '';
            position: absolute;
            inset: 14px;
            border: 3px solid #f5f5f0;
            box-shadow: inset 1px 1px 3px rgba(0,0,0,0.2);
            pointer-events: none;
        }
        
        /* Gallery Gold Frame - Brushed aluminum gold */
        .frame-gallery {
            padding: 22px;
            background: 
                linear-gradient(145deg, 
                    #e8c84a 0%, 
                    #d4af37 15%, 
                    #a08520 30%,
                    #d4af37 50%,
                    #f0d861 65%,
                    #d4af37 80%,
                    #8b6914 100%);
            border-radius: 2px;
            box-shadow: 
                /* Gold highlights */
                inset 2px 2px 0 rgba(255,235,150,0.6),
                inset -2px -2px 0 rgba(100,75,10,0.5),
                /* Depth layers */
                inset 0 0 0 5px #8b6914,
                inset 0 0 0 7px rgba(255,215,0,0.4),
                inset 0 0 0 9px #6b4f10,
                /* Wall shadow */
                8px 14px 45px rgba(0,0,0,0.6),
                4px 8px 25px rgba(0,0,0,0.4),
                /* Gold glow */
                0 0 30px rgba(212,175,55,0.25);
        }
        .frame-gallery::before {
            content: '';
            position: absolute;
            inset: 10px;
            background: linear-gradient(180deg, rgba(255,235,150,0.15) 0%, transparent 40%);
            pointer-events: none;
        }
        .frame-gallery::after {
            content: '';
            position: absolute;
            inset: 18px;
            border: 4px solid #faf8f0;
            box-shadow: inset 1px 1px 4px rgba(0,0,0,0.15);
            pointer-events: none;
        }
        
        /* Collector Metal - HD Aluminum float mount */
        .frame-collector {
            padding: 8px;
            background: linear-gradient(160deg, 
                #f0f0f0 0%, 
                #c8c8c8 20%, 
                #e0e0e0 40%,
                #a8a8a8 60%,
                #d0d0d0 80%,
                #b8b8b8 100%);
            border-radius: 3px;
            box-shadow: 
                /* Metal sheen */
                inset 1px 1px 0 rgba(255,255,255,0.9),
                inset -1px -1px 0 rgba(0,0,0,0.2),
                /* Float mount gap shadow */
                inset 0 0 15px rgba(0,0,0,0.1),
                /* Wall shadow - deeper for float effect */
                12px 16px 50px rgba(0,0,0,0.5),
                6px 10px 30px rgba(0,0,0,0.4),
                /* Edge definition */
                0 0 0 1px rgba(0,0,0,0.1);
        }
        .frame-collector .frame-image {
            box-shadow: 
                inset 0 0 40px rgba(0,0,0,0.15),
                inset 0 0 10px rgba(0,0,0,0.1);
            border-radius: 1px;
        }
        
        /* Museum Ornate Frame - Gilded baroque */
        .frame-museum {
            padding: 32px;
            background: 
                linear-gradient(145deg, 
                    #f0d861 0%,
                    #d4af37 10%,
                    #8b6914 25%,
                    #d4af37 40%,
                    #e8c84a 50%,
                    #d4af37 60%,
                    #6b4f10 75%,
                    #d4af37 90%,
                    #a08520 100%);
            border-radius: 3px;
            box-shadow: 
                /* Ornate outer edge */
                inset 3px 3px 0 rgba(255,235,150,0.7),
                inset -3px -3px 0 rgba(80,60,5,0.6),
                /* Multiple depth rings */
                inset 0 0 0 6px #705010,
                inset 0 0 0 8px rgba(255,215,0,0.5),
                inset 0 0 0 12px #8b6914,
                inset 0 0 0 14px rgba(255,235,150,0.3),
                inset 0 0 0 18px #6b4f10,
                /* Deep wall shadow */
                10px 18px 60px rgba(0,0,0,0.6),
                5px 10px 35px rgba(0,0,0,0.5),
                /* Rich gold glow */
                0 0 50px rgba(212,175,55,0.35),
                0 0 20px rgba(212,175,55,0.2);
        }
        .frame-museum::before {
            content: '‚ú¶';
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            color: rgba(255,245,200,0.7);
            text-shadow: 0 1px 2px rgba(0,0,0,0.4);
        }
        .frame-museum::after {
            content: '';
            position: absolute;
            inset: 26px;
            border: 5px solid #fffef8;
            box-shadow: 
                inset 2px 2px 6px rgba(0,0,0,0.12),
                0 0 0 2px rgba(139,105,20,0.3);
            pointer-events: none;
        }
        
        .frame-image {
            display: block;
            width: 240px;
            height: 180px;
            object-fit: cover;
            position: relative;
            z-index: 1;
        }
        
        .frame-label {
            text-align: center;
            margin-top: 20px;
            font-family: 'Cinzel', serif;
            font-size: 0.85rem;
            color: rgba(212,175,55,0.8);
            letter-spacing: 2px;
        }

        .capture-info {
            padding: 20px;
        }
        .capture-label {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            color: rgba(212,175,55,0.6);
            letter-spacing: 2px;
            margin-bottom: 8px;
        }
        
        .product-select {
            width: 100%;
            padding: 12px;
            background: rgba(20,15,18,0.9);
            color: #f4e4ba;
            border: 1px solid rgba(212,175,55,0.4);
            border-radius: 6px;
            font-family: 'Cormorant Garamond', serif;
            font-size: 1rem;
            margin-bottom: 12px;
            cursor: pointer;
        }
        .product-select:focus {
            outline: none;
            border-color: #d4af37;
        }
        .product-select option {
            background: #1a1018;
            padding: 10px;
        }
        
        .price-display {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            color: #d4af37;
            text-align: center;
            margin: 12px 0;
        }
        
        .order-btn {
            width: 100%;
            padding: 14px 20px;
            border: 2px solid #d4af37;
            background: linear-gradient(180deg, rgba(212,175,55,0.3), rgba(139,105,20,0.4));
            color: #d4af37;
            font-family: 'Cinzel', serif;
            font-size: 0.9rem;
            letter-spacing: 2px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            border-radius: 6px;
        }
        .order-btn:hover {
            background: linear-gradient(180deg, #d4af37, #8b6914);
            color: #0a0608;
            box-shadow: 0 0 30px rgba(212,175,55,0.5);
        }
        .order-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .tier-badge {
            display: inline-block;
            padding: 3px 10px;
            font-size: 0.65rem;
            letter-spacing: 1px;
            border-radius: 3px;
            margin-left: 8px;
            font-family: 'Cinzel', serif;
        }
        .tier-standard { background: rgba(100,100,100,0.4); color: #ccc; }
        .tier-gallery { background: rgba(212,175,55,0.3); color: #d4af37; }
        .tier-collector { background: rgba(200,200,200,0.3); color: #e8e8e8; }
        .tier-museum { background: rgba(255,215,0,0.4); color: #ffd700; }
        
        .info-section {
            background: rgba(20,15,25,0.5);
            border: 1px solid rgba(212,175,55,0.2);
            border-radius: 12px;
            padding: 35px;
            margin-top: 40px;
            backdrop-filter: blur(10px);
        }
        .info-section h3 {
            font-family: 'Cinzel', serif;
            color: #d4af37;
            font-size: 1.1rem;
            letter-spacing: 3px;
            margin-bottom: 15px;
        }
        .info-section p {
            line-height: 1.7;
            margin-bottom: 12px;
            color: rgba(244,228,186,0.9);
        }
        
        .product-tiers {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .tier-card {
            background: rgba(15,10,12,0.8);
            border: 1px solid rgba(212,175,55,0.2);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }
        .tier-card h4 {
            font-family: 'Cinzel', serif;
            color: #d4af37;
            margin-bottom: 15px;
        }

        /* Tier preview frames in info section */
        .tier-frame-demo {
            width: 80px;
            height: 60px;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #1a1518;
        }
        .tier-frame-demo.demo-standard {
            border: 8px solid #2a2a2a;
            box-shadow: inset 0 0 0 1px rgba(255,255,255,0.05);
        }
        .tier-frame-demo.demo-gallery {
            border: 10px solid;
            border-image: linear-gradient(145deg, #d4af37, #8b6914) 1;
            box-shadow: 0 0 15px rgba(212,175,55,0.3);
        }
        .tier-frame-demo.demo-collector {
            border: 4px solid;
            border-image: linear-gradient(135deg, #e8e8e8, #888) 1;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.4);
        }
        .tier-frame-demo.demo-museum {
            border: 16px solid;
            border-image: linear-gradient(145deg, #d4af37, #8b6914, #d4af37) 1;
            box-shadow: 0 0 20px rgba(212,175,55,0.4);
        }
        .tier-frame-demo span {
            font-size: 0.6rem;
            color: rgba(212,175,55,0.4);
            font-family: 'JetBrains Mono', monospace;
        }
        
        .tier-card ul {
            list-style: none;
            font-size: 0.85rem;
            color: rgba(244,228,186,0.8);
            text-align: left;
        }
        .tier-card li {
            padding: 5px 0;
            padding-left: 18px;
            position: relative;
        }
        .tier-card li::before {
            content: '‚öú';
            position: absolute;
            left: 0;
            font-size: 0.6rem;
            color: #d4af37;
        }
        
        .contact-footer {
            text-align: center;
            padding: 40px;
            border-top: 1px solid rgba(212,175,55,0.2);
            margin-top: 40px;
        }
        .contact-footer p {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: rgba(244,228,186,0.6);
            margin-bottom: 8px;
        }
        .contact-footer a {
            color: #d4af37;
            text-decoration: none;
        }
        
        .success-banner, .error-banner {
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            text-align: center;
            font-family: 'Cinzel', serif;
        }
        .success-banner {
            background: rgba(74,222,128,0.2);
            border: 1px solid rgba(74,222,128,0.5);
            color: #4ade80;
        }
        .error-banner {
            background: rgba(248,113,113,0.2);
            border: 1px solid rgba(248,113,113,0.5);
            color: #f87171;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(212,175,55,0.3);
            border-top-color: #d4af37;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
            vertical-align: middle;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: rgba(244,228,186,0.5);
        }
        .empty-state h3 {
            font-family: 'Cinzel', serif;
            color: rgba(212,175,55,0.6);
            margin-bottom: 15px;
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .header {
                padding: 25px 15px;
            }
            .header h1 {
                font-size: 1.5rem;
                letter-spacing: 3px;
            }
            .header p {
                font-size: 0.95rem;
            }
            
            .main-content {
                padding: 20px 15px;
            }
            
            .section-title {
                font-size: 1.2rem;
                letter-spacing: 2px;
                margin-bottom: 25px;
            }
            
            .captures-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .frame-preview-container {
                padding: 20px;
                min-height: 320px;
            }
            
            .frame-image {
                width: 200px;
                height: 150px;
            }
            
            .frame-standard { padding: 14px; }
            .frame-gallery { padding: 18px; }
            .frame-collector { padding: 6px; }
            .frame-museum { padding: 24px; }
            
            .capture-info {
                padding: 15px;
            }
            
            .product-select {
                padding: 14px 12px;
                font-size: 1rem;
            }
            
            .price-display {
                font-size: 1.3rem;
            }
            
            .order-btn {
                padding: 16px 20px;
                font-size: 1rem;
            }
            
            .info-section {
                padding: 25px 20px;
                margin-top: 30px;
            }
            
            .product-tiers {
                grid-template-columns: 1fr 1fr;
                gap: 12px;
            }
            
            .tier-card {
                padding: 15px 12px;
            }
            .tier-card h4 {
                font-size: 0.9rem;
            }
            .tier-badge {
                display: block;
                margin: 8px 0 0 0;
            }
            .tier-card ul {
                font-size: 0.75rem;
            }
            .tier-frame-demo {
                width: 60px;
                height: 45px;
                margin-bottom: 10px;
            }
            
            .contact-footer {
                padding: 30px 15px;
            }
        }
        
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.2rem;
                letter-spacing: 2px;
            }
            
            .product-tiers {
                grid-template-columns: 1fr;
            }
            
            .tier-badge {
                display: inline-block;
                margin-left: 8px;
            }
            
            .frame-image {
                width: 180px;
                height: 135px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>‚öú Order Your Portrait ‚öú</h1>
        <p>Museum-Quality Prints ‚Ä¢ Direct to Your Door</p>
        <a href="index.html" class="back-link">‚Üê Return to Experience</a>
    </div>
    
    <div class="main-content">
        <div id="statusBanner"></div>
        
        <h2 class="section-title">Your Captured Portraits</h2>
        
        <div class="captures-grid" id="capturesGrid"></div>

        <div class="info-section">
            <h3>Print Tiers</h3>
            <div class="product-tiers">
                <div class="tier-card">
                    <div class="tier-frame-demo demo-standard"><span>YOUR ART</span></div>
                    <h4>Standard <span class="tier-badge tier-standard">FROM $125</span></h4>
                    <ul>
                        <li>Gicl√©e on fine art paper</li>
                        <li>Classic matte black frame</li>
                        <li>100+ year color guarantee</li>
                    </ul>
                </div>
                <div class="tier-card">
                    <div class="tier-frame-demo demo-gallery"><span>YOUR ART</span></div>
                    <h4>Gallery <span class="tier-badge tier-gallery">FROM $350</span></h4>
                    <ul>
                        <li>Gicl√©e on cotton rag</li>
                        <li>Brushed gold aluminum frame</li>
                        <li>Museum-grade mounting</li>
                    </ul>
                </div>
                <div class="tier-card">
                    <div class="tier-frame-demo demo-collector"><span>YOUR ART</span></div>
                    <h4>Collector <span class="tier-badge tier-collector">FROM $395</span></h4>
                    <ul>
                        <li>HD dye-infused aluminum</li>
                        <li>Float mount included</li>
                        <li>Scratch resistant finish</li>
                    </ul>
                </div>
                <div class="tier-card">
                    <div class="tier-frame-demo demo-museum"><span>YOUR ART</span></div>
                    <h4>Museum <span class="tier-badge tier-museum">FROM $850</span></h4>
                    <ul>
                        <li>Gicl√©e on archival cotton</li>
                        <li>Ornate gilded frame</li>
                        <li>Certificate of authenticity</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="info-section">
            <h3>About Your Print</h3>
            <p>Each portrait is printed using gicl√©e technology by Fine Art Trade Guild approved facilities, ensuring museum-quality reproduction with a 100+ year color guarantee. Your artwork ships directly from our global print network to your door.</p>
            <p>All prints are produced on demand and typically ship within 3-5 business days. International shipping available to US, Canada, UK, Australia, and EU.</p>
        </div>
    </div>
    
    <div class="contact-footer">
        <p>Questions? <a href="mailto:kristabluedoor@gmail.com">kristabluedoor@gmail.com</a></p>
        <p>¬© 2024 Krista Faist ‚Ä¢ The Mirror's Echo</p>
    </div>
    
    <script>
        const API_URL = 'https://api-production-c977.up.railway.app';
        const stripe = Stripe('pk_live_51SL6QhADdiQo1kIcChk759IFrqbhz8QZIkAdpeB97CQKydGSXv0MUB6oDlLb4Yjl2nE5LY0Eb4PCAUpQSxw4DPBg003xTZiXPn');
        
        const PRODUCTS = {
            'standard-8x10': { name: 'Standard 8√ó10"', price: 125, tier: 'standard', frame: 'frame-standard' },
            'standard-16x20': { name: 'Standard 16√ó20"', price: 225, tier: 'standard', frame: 'frame-standard' },
            'gallery-16x20': { name: 'Gallery Gold 16√ó20"', price: 350, tier: 'gallery', frame: 'frame-gallery' },
            'gallery-24x36': { name: 'Gallery Gold 24√ó36"', price: 550, tier: 'gallery', frame: 'frame-gallery' },
            'collector-16': { name: 'Metal Print 16√ó16"', price: 395, tier: 'collector', frame: 'frame-collector' },
            'collector-24': { name: 'Metal Print 24√ó24"', price: 595, tier: 'collector', frame: 'frame-collector' },
            'museum-24x36': { name: 'Museum Ornate 24√ó36"', price: 850, tier: 'museum', frame: 'frame-museum' }
        };

        // Check URL params for success/cancel
        const params = new URLSearchParams(window.location.search);
        if (params.get('success')) {
            document.getElementById('statusBanner').innerHTML = 
                '<div class="success-banner">‚úì Order placed successfully! Your print will ship within 3-5 business days.</div>';
        } else if (params.get('canceled')) {
            document.getElementById('statusBanner').innerHTML = 
                '<div class="error-banner">Order was canceled. Your captures are still saved.</div>';
        }
        
        function loadCaptures() {
            const grid = document.getElementById('capturesGrid');
            let stored = localStorage.getItem('baroqueCaptures');
            if (!stored) stored = localStorage.getItem('goldenCaptures');
            const captures = stored ? JSON.parse(stored) : {};
            
            const hasCaptures = Object.keys(captures).some(k => captures[k]);
            
            if (!hasCaptures) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1/-1;">
                        <h3>No Captures Yet</h3>
                        <p>Return to the experience and capture some portraits first!</p>
                        <a href="index.html" class="back-link" style="margin-top:20px;">‚Üê Go to Experience</a>
                    </div>
                `;
                return;
            }
            
            for (let i = 1; i <= 12; i++) {
                const capture = captures[i];
                if (!capture) continue;
                
                const card = document.createElement('div');
                card.className = 'capture-card';
                card.innerHTML = `
                    <div class="frame-preview-container">
                        <div class="frame-preview frame-standard" id="framePreview-${i}">
                            <img src="${capture.image}" alt="Capture ${i}" class="frame-image" id="frameImg-${i}">
                        </div>
                    </div>
                    <div class="frame-label" id="frameLabel-${i}">Standard Black Frame</div>
                    <div class="capture-info">
                        <div class="capture-label">EXP_${String(i).padStart(2, '0')}</div>
                        <select class="product-select" id="product-${i}" onchange="updatePreview(${i})">
                            <option value="">Select Print Option...</option>
                            <optgroup label="‚¨õ Standard ‚Äî Black Frame">
                                <option value="standard-8x10">8√ó10" Framed ‚Äî $125</option>
                                <option value="standard-16x20">16√ó20" Framed ‚Äî $225</option>
                            </optgroup>
                            <optgroup label="üü® Gallery ‚Äî Gold Frame">
                                <option value="gallery-16x20">16√ó20" Gold Frame ‚Äî $350</option>
                                <option value="gallery-24x36">24√ó36" Gold Frame ‚Äî $550</option>
                            </optgroup>
                            <optgroup label="‚¨ú Collector ‚Äî Metal Print">
                                <option value="collector-16">16√ó16" Metal ‚Äî $395</option>
                                <option value="collector-24">24√ó24" Metal ‚Äî $595</option>
                            </optgroup>
                            <optgroup label="üëë Museum ‚Äî Ornate Gold">
                                <option value="museum-24x36">24√ó36" Ornate ‚Äî $850</option>
                            </optgroup>
                        </select>
                        <div class="price-display" id="price-${i}">$125</div>
                        <button class="order-btn" id="btn-${i}" onclick="orderPrint(${i})" disabled>
                            Select a Size
                        </button>
                    </div>
                `;
                grid.appendChild(card);
            }
        }

        const FRAME_LABELS = {
            'frame-standard': 'Standard Black Frame',
            'frame-gallery': 'Gallery Gold Frame',
            'frame-collector': 'HD Metal Print',
            'frame-museum': 'Museum Ornate Frame'
        };
        
        function updatePreview(slot) {
            const select = document.getElementById(`product-${slot}`);
            const priceDiv = document.getElementById(`price-${slot}`);
            const btn = document.getElementById(`btn-${slot}`);
            const framePreview = document.getElementById(`framePreview-${slot}`);
            const frameLabel = document.getElementById(`frameLabel-${slot}`);
            const productId = select.value;
            
            if (productId && PRODUCTS[productId]) {
                const product = PRODUCTS[productId];
                priceDiv.textContent = `$${product.price}`;
                btn.disabled = false;
                btn.textContent = 'Order Now ‚Üí';
                
                // Update frame preview
                framePreview.className = `frame-preview ${product.frame}`;
                frameLabel.textContent = FRAME_LABELS[product.frame];
                
                // Animate the change
                framePreview.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    framePreview.style.transform = 'scale(1)';
                }, 150);
            } else {
                priceDiv.textContent = '$125';
                btn.disabled = true;
                btn.textContent = 'Select a Size';
                framePreview.className = 'frame-preview frame-standard';
                frameLabel.textContent = 'Standard Black Frame';
            }
        }
        
        async function orderPrint(slot) {
            const select = document.getElementById(`product-${slot}`);
            const btn = document.getElementById(`btn-${slot}`);
            const productId = select.value;
            
            if (!productId) return;
            
            let stored = localStorage.getItem('baroqueCaptures');
            if (!stored) stored = localStorage.getItem('goldenCaptures');
            const captures = JSON.parse(stored);
            const capture = captures[slot];
            
            if (!capture) {
                alert('Capture not found');
                return;
            }
            
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span>Processing...';
            
            try {
                // Save image to server
                await fetch(`${API_URL}/save-image`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        orderId: `order-${Date.now()}-${slot}`,
                        imageData: capture.image
                    })
                });
                
                // Create checkout session
                const res = await fetch(`${API_URL}/create-checkout`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        productId: productId,
                        imageData: capture.image,
                        returnUrl: window.location.href.split('?')[0]
                    })
                });
                
                const data = await res.json();
                
                if (data.url) {
                    window.location.href = data.url;
                } else if (data.sessionId) {
                    const result = await stripe.redirectToCheckout({ sessionId: data.sessionId });
                    if (result.error) throw new Error(result.error.message);
                } else {
                    throw new Error(data.error || 'Failed to create checkout');
                }
            } catch (err) {
                console.error('Order error:', err);
                alert('Error creating order: ' + err.message);
                btn.disabled = false;
                btn.textContent = 'Order Now ‚Üí';
            }
        }
        
        window.addEventListener('load', loadCaptures);
    </script>
</body>
</html>
